# C#面试题集锦附答案

1. `解释一下C#中的sealed`

    密封类用于防止类从其他类继承。 因此“sealed”修饰符也可以与方法一起使用，以避免在子类中重写的方法.

2. `值类型和引用类型的区别`

    值类型包括简单类型、结构体类型和枚举类型，引用类型包括自定义类、数组、接口、委托等。
    - 赋值方式：将一个值类型变量赋给另一个值类型变量时，将复制包含的值。这与引用类型变量的赋值不同，引用类型变量的赋值只复制对象的引用（即内存地址，类似C++中的指针），而不复制对象本身。
    - 继承：值类型不可能派生出新的类型，所有的值类型均隐式派生自 System.ValueType。但与引用类型相同的是，结构也可以实现接口。
    - null：与引用类型不同，值类型不可能包含 null 值。然而，可空类型功能允许将 null 赋给值类型。
    - 每种值类型均有一个隐式的默认构造函数来初始化该类型的默认值，值类型初始会默认为0，引用类型默认为null。
    2.5 值类型存储在栈中，引用类型存储在托管堆中。

3. `结构和类的区别`

    - 结构是值类型, 类是引用类型;
    - class需要new关键字实例化对象, struct可以不使用new关键字实例化对象;
    - 结构体不支持抽象, 类支持;

4. `delegate是值类型还是引用类型? enum, int[]和string呢?`

    enum枚举是值类型,其他的都是引用类型.

5. `堆和栈的区别`

    - 值类型大多分配在栈上, 引用类型都分配在堆上;
    - 栈由操作系统管理, 栈上的变量在其作用域完成后就被释放, 效率高但是空间有限.
    - 栈是基于线程的.所以栈有线程栈.而堆是基于进程的,一个进程分配一个堆.堆的大小由GC根据运行情况动态控制;

6. `结构对象能够分配到堆上面吗?什么情况下发生,有什么需要注意的吗?`

    结构是值类型,有两种情况会将结构分配到堆上面:
    - 结构作为class的字段或者属性时,会随着class分配到堆上面;
    - 装箱后会在堆中存储,尽量避免值类型的装箱, 值类型的装箱和拆箱都有性能损失.

7. `参数的值传递和引用传递的区别`

    - 按值传递:对于值类型的参数传递的是值得拷贝副本.对于引用类型的参数传递的是引用变量的内存地址,他们指向的还是同一个变量;
    - 按照引用传递: 通过ref和out传递参数的内存地址, 值类型和引用类型的效果是相通的.

8. `out和ref区别`

    - out和ref都是传递变量所引用的地址.
    - 他们使用的机制有所不同, ref要求参数在使用之前要显示的初始化, out要在方法的内部初始化.
    - 定义的两个方法如果仅有的区别是参数的out和ref,则不允许被重载. 因为编译角度来看二者的本质是相同的.

9. `有几种方法判断是值类型还是引用类型?`

    简单来说继承自System.ValueType的是值类型,否则为引用类型.

10. `C#支持哪些预定义的值类型和引用类型`

    - 值类型: 整数,浮点数, 字符, bool和decimal
    - 引用类型: Object, String

11. `说说值类型和引用类型的生命周期`

    - 值类型在其作用域完成后释放.
    - 引用类型由GC进行回收.
    - 可参考问题5.

12. `如果结构体中定义了引用类型,那么在内存中如何存储?`

    ```csharp

    public struct MyStruct  
    {
        public int Index;
        public User User;  
    }
    ```

    Mystruct存储在栈中, 其字段存储在堆中, MyStruct.User字段存储指向User对象的内存地址.